<!DOCTYPE html>
<html>
<meta charset="utf-8">
<head>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            overflow: hidden;
        }
        #container {
            border: 1px solid #666;
            border-radius: 100%;
            width: 600px;
            height: 600px;
            position: absolute;
            top: 50%;
            left: 50%;
            margin-top: -300px;
            margin-left: -300px;
        }
        .ball {
            text-align: center;
            position: absolute;
            background-color: #CCC;
            border-radius: 100%;
            line-height: 80px;
            border: 1px solid #999;
            margin-left: -40px;
            margin-top: -40px;
            width: 80px;
            height: 80px;
        }
    </style>
</head>
<body>
    <div id="container">
    </div>
</body>
<script>
    function Vector( x, y ) {
        if( x instanceof Vector ) {
            var from = x, to = y;
            this.x = to.x - from.x;
            this.y = to.y - from.y;
        } else {                
            this.x = x;
            this.y = y;
        }
        if ( !Vector.initialed ) {
            Vector.initialed = true;
            Vector.prototype = {
                length: function() {
                    return Math.sqrt(this.x * this.x + this.y * this.y);
                },
                add: function( unknown ) {
                    if ( unknown instanceof Vector ) {
                        return new Vector( this.x + unknown.x, this.y + unknown.y );
                    } else {
                        return new Vector( this.x + unknown, this.y + unknown);
                    }
                },
                minus: function( unknown ) {
                    if ( unknown instanceof Vector ) {
                        return new Vector( this.x - unknown.x, this.y - unknown.y );
                    } else {
                        return new Vector( this.x - unknown, this.y - unknown);
                    }
                },
                multipy: function( unknown ) {
                    if ( unknown instanceof Vector ) {
                        return this.x * unknown.x + this.y * unknown.y;
                    } else {
                        return new Vector( this.x * unknown, this.y * unknown);
                    }
                },
                uniform: function() {
                    return this.multipy( 1 / this.length() );
                },
                reflact: function( normal ) {
                    var I = this, N = normal;
                    return I.minus( ( N.multipy( 2 * I.multipy(N) ) ) );
                },
                reverse: function() {
                    return this.multipy(-1);
                }
            }
        }
    }

    names = '范俊梅,雷志兴,姚晓谊,陈励,王黎明,刘凯,杨尊程,齐伟,高洁璇,陆泰宁,肖昆,陆金谭,黄凯,韩璟,党弘扬,陈峥,宋雅儒,莫卓颖,刘帅,张灿,周美美,陈著,皮成,张楠,候迦壹,唐益龙,郭金辉,冯尚实,张袁炜,郝茹,陈浩然,樊中恺,郭斌,穆瑞强,孙鹤飞,王慧,严孙荣,龚伟,吴忧,贾铮,曹栋清,暨灿,李雪韬,郁浩,王加鹏,刘元晨,刘骥,王永青,熊正祥,李学健,桂琴琴,郭宇霆,余光灿,侯鹏,胡大民'.split(',');
    var balls = [];
    var container = document.getElementById('container');
    var WALL_RADIUS = 300,
        BALL_RADIUS = 40,
        WALL_CENTER = new Vector( WALL_RADIUS, WALL_RADIUS );


    function rand (min, max) {
        return min + Math.round((max - min) * Math.random());
    }

    function frame () {
        moveBalls();
        setTimeout(frame, 20);
    }

    function moveBalls() {
        var i, j;
        for(i = 0; i < balls.length; i++) {
            var ball = balls[i];
            ball.v = ball.v.add(ball.a);
            if(ball.v.length() < 0.5) ball.v = new Vector(0,0);
            if( i == rand(0, 100) ) ball.v = new Vector(rand(10, 10), rand(-50, 10));
            hitWallTest(ball);
            for(j = i + 1; j < balls.length; j++) {
                hitBallTest(ball, balls[j]);
            }
            ball.s = ball.s.add(ball.v);
            updateBallStyle(ball);
        }
    }

    function updateBallStyle( ball ) {
        ball.style.left = ball.s.x + 'px';
        ball.style.top = ball.s.y + 'px';
    }

    function hitWallTest(ball) {
        var d = new Vector( ball.s, WALL_CENTER );
        if ( BALL_RADIUS + d.length() > WALL_RADIUS - 5) {
            var n = d.uniform();
            ball.v = ball.v.reflact(n).multipy(0.85);
        }
    }

    function hitBallTest(b1, b2) {
        // var d = new Vector(b2.s, b1.s)
        // if( d.length() < 2 * BALL_RADIUS - 5 ) {
        //     var v1 = b1.v, v2 = b2.v;
        //     b1.v = v2;
        //     b2.v = v1;
        // }
    }

    function makeBalls() {        
        for(var i = 0; i < names.length; i++) {
            var div = document.createElement('div');
            div.classList.add('ball');
            div.innerHTML = names[i];
            div.s = new Vector( rand(172, 428), rand(172, 428) );
            div.v = new Vector(0, 0);
            div.a = new Vector(0, 1);
            container.appendChild(div);
            balls.push(div);
        }
    }

    function start() {
        makeBalls();
        frame();
    }
    start();
</script>
</html>